# DMX Interval Controller

Een non-blocking DMX interval controller met OLED menu en rotary encoder.  
Gebouwd op een Arduino en een MAX485 (RS485) driver.

---

## Hardware

### Microcontroller
- Arduino UNO / Nano

### Display
- OLED SSD1351 (SPI, 128x128)
- CS   → Pin 10
- DC   → Pin 9
- RST  → Pin 7
- MOSI → Pin 11 (Hardware SPI)
- SCK  → Pin 13 (Hardware SPI)
- VCC  → 5V
- GND  → GND


### Rotary Encoder
- A → Pin 5  
- B → Pin 4  
- SW → Pin 2  
- GND → GND  

### DMX (RS485 via MAX485)
- DI → Pin 8 (DMX data)
- DE → 5V (Transmit enable)
- RE → GND (Receiver uitgeschakeld)
- RO → Niet gebruikt
- VCC → 5V
- GND → GND

---

## Functionaliteit

Het systeem stuurt **één DMX kanaal** aan in een herhalende cyclus:

```
WAIT → ACTIVE → WAIT → ACTIVE → ...
```

### Menu Items

1. **Channel**
   - Instelbaar van 1–512  
   - Wrap-around actief

2. **Interval (MM:SS)**
   - Wachttijd vóór activatie  
   - Minuten + seconden apart instelbaar  

3. **Duration**
   - Actieve tijd in seconden  

4. **Volume**
   - DMX waarde (1–255)  
   - Stapgrootte = 5  

---

## Bediening

### Encoder draaien
- **SELECT mode** → navigeren tussen items  
- **EDIT mode** → waarde aanpassen  

### Encoder indrukken
- SELECT → EDIT  
- EDIT → bevestigen  

Bij Timer:
- Eerst minuten bewerken  
- Daarna seconden  
- Dan terug naar SELECT  

Wanneer *Volume* wordt bevestigd: (einde instelling = start) 
→ `startDmxSequence()` wordt gestart  

---

## DMX Werking

De timing is volledig **non-blocking** en gebruikt `millis()`.

### States

- `DMX_IDLE`
- `DMX_WAIT`
- `DMX_ACTIVE`

### Gedrag

| State      | DMX Output |
|------------|------------|
| WAIT       | 0          |
| ACTIVE     | Volume     |

DMX frames worden ongeveer 30x per seconde verstuurd.

---

## Belangrijke Eigenschappen

- Geen `delay()` in timing-logica  
- Geen overflow bij max 59:59 interval  
- OLED redraw enkel bij wijzigingen  
- Volledig non-blocking  
- Timer kan aangepast worden zonder blokkering  

---

## Voorbeeld Cyclus

Instellingen:
- Interval: 20 seconden  
- Duration: 10 seconden  
- Volume: 200  

Resultaat:

```
20s UIT
10s AAN (waarde 200)
20s UIT
10s AAN
...
```

Herhaalt oneindig.

---

## Bestanden

- `main.ino` → Hoofdprogramma  
- `dmxController()` → State machine  
- `startDmxSequence()` → Start nieuwe cyclus  
- UI functies → OLED rendering